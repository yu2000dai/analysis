# 確率分布と乱数

## 離散型の場合

**問題** 理想的な6面体のサイコロについて，次の問に答えよ。

* （シミュレーション）サイコロを6回振った結果のデータを作り，その平均と分散，標準偏差を求めよ。
* （理論）
    * サイコロの出る目Xは**確率変数**である。Xがxである確率<img src="https://latex.codecogs.com/gif.latex?\inline&space;P(X=x)=f(x)" />はxの関数である。このような<img src="https://latex.codecogs.com/gif.latex?\inline&space;f(x)" />を**確率分布**と呼ぶ。サイコロが理想的な6面体のとき，<img src="https://latex.codecogs.com/gif.latex?\inline&space;f(x)" />は具体的にどうなるか。
    * 確率変数Xの**期待値**<img src="https://latex.codecogs.com/gif.latex?\inline&space;E(X)" />は，（Xが離散的なとき）<img src="https://latex.codecogs.com/gif.latex?\inline&space;\sum&space;x&space;f(x)" />で定義される（和はXの取り得るすべてのxについて取る）。理想的な6面体のサイコロの出る目Xの期待値を求めよ。
    * 確率変数Xの**分散**<img src="https://latex.codecogs.com/gif.latex?\inline&space;V(X)" />は，（Xが離散的なとき）<img src="https://latex.codecogs.com/gif.latex?\inline&space;\sum&space;(x-E(X))^2&space;f(x)" />で定義される（和はXの取り得るすべてのxについて取る）。理想的な6面体のサイコロの出る目Xの分散を求めよ。
    * 確率変数Xの**標準偏差**は，<img src="https://latex.codecogs.com/gif.latex?\inline&space;V(X)" />の正の平方根で定義される。理想的な6面体のサイコロの出る目Xの標準偏差を求めよ。

**問題** 理想的な12面体のサイコロについて，次の問に答えよ。

* （シミュレーション）30回投げるシミュレーションを行い，出た目の平均，分散，標準偏差を調べよ。
* （理論）サイコロの出る目の確率分布，期待値，分散，標準偏差を求めよ。

**問題** 当選金額が100万円，当選確率が10%のくじについて，次の問に答えよ。

* （シミュレーション）100回買った場合をシミュレートし，当選金額の平均と分散，標準偏差を求めよ。
* （理論）当選金額の確率分布，期待値，分散，標準偏差を求めよ。

**問題（レポート課題）** 1等（100万円）の当選確率が1%，2等（50万円）の当選確率が5%のくじについて，上の問題と同様のことを調べよ。

**問題** 表の出る確率がp，裏の出る確率がq=1-pであるコインを投げて，表が出ると1点，裏が出ると0点とする（表が出る回数を数えていると考えてもよい）。このコインを投げるという試行をn回繰り返したとする。そのときの合計点Xは確率変数であり，その確率分布は二項分布と呼ばれる。ここで述べた二項分布の確率分布（合計点がちょうどxになる確率）を書け。
p(X=k)=nCkpkqn⁻k
**問題** 「二項分布」を英訳せよ。
binomial distribution
**問題** 理想的なコインを30回投げて表が出る回数をXとする。次の問に答えよ。

* （シミュレーション）実験を10回行い，Xの平均と分散を求めよ。ヒント：`RANDBETWEEN`を300回使う。
* （シミュレーション）実験を10回行い，Xの平均と分散を求めよ。ヒント：`RANDBETWEEN`を30回と，データテーブルを使う。
* （理論）確率分布，期待値，分散を求めよ。ヒント：`COMBIN`を使う。
* （理論）確率分布，期待値，分散を求めよ。ヒント：`BINOM.DIST`を使う。
* （理論）二項分布の期待値と分散をWikipediaで調べ，n=30，p=0.5の時の値を求めよ。
* （理論）二項分布の期待値，<img src="https://latex.codecogs.com/gif.latex?%5Csum_%7Bk%3D0%7D%5Enk%5Cbinom%7Bn%7D%7Bk%7Dp%5Ek%281-p%29%5E%7Bn-k%7D" />を数式処理システムで求めよ。得られた式に，n=30，p=1/2を代入せよ。ヒント：Wolfram/Alphaに「`Sum[k Binomial[n, k] p^k (1 - p)^(n - k), {k, 0, n}]`」を問う。
* （理論）二項分布の分散，<img src="https://latex.codecogs.com/gif.latex?%5Csum_%7Bk%3D0%7D%5En%20%28k-np%29%5E2%5Cbinom%7Bn%7D%7Bk%7Dp%5Ek%281-p%29%5E%7Bn-k%7D" />を数式処理システムで求めよ。得られた式に，n=30，p=1/2を代入せよ。ヒント：Wolfram/Alphaに「`Sum[(k - n p)^2 Binomial[n, k] p^k (1 - p)^(n - k), {k, 0, n}]`」を問う。
* （理論）二項分布の期待値を紙と鉛筆で求めよ。
* **（レポート課題）**（理論）二項分布の分散を紙と鉛筆で求めよ。

**問題** 当たる確率が0.1のガチャを10回引いて、1回も当たらない確率をExcelで求めよ。

**問題** 「当たる確率が0.1のガチャを20回引く」ということを100人が試す。当たった回数のヒストグラム（縦軸は人数）をExcelで描け。ヒント：Wolfram/Alphaに「`BinomialDistribution[10, 0.1]`」を問う。

**問題** 「当たる確率が0.1のガチャを40回引く」ということを100人が試す。当たった回数のヒストグラム（縦軸は人数）をExcelで描け。

**問題（レポート課題）** 「当たる確率が0.1のガチャを100回引く」ということを100人が試す。当たった回数のヒストグラム（縦軸は人数）をExcelで描け。

2019年度はここまで

## 連続型の場合

**問題** 確率変数Xが連続値を取る場合，Xが<img src="https://latex.codecogs.com/gif.latex?\inline&space;[x,&space;x&plus;\Delta&space;x]" />に含まれる確率<img src="https://latex.codecogs.com/gif.latex?\inline&space;P(x\le&space;X&space;\le&space;x&plus;\Delta&space;x)=f(x)" />を考え，これを確率密度関数と呼ぶ。Xがx以下となる確率<img src="https://latex.codecogs.com/gif.latex?\inline&space;F(x)" />は<img src="https://latex.codecogs.com/gif.latex?\inline&space;\int_{-\infty}^x&space;f(k)\,dk" />であることを納得せよ。

**問題** 人間の身長は，正規分布になっていることが知られている。例として，平均160，標準偏差5の正規分布の確率密度関数のグラフを描け。ヒント：Excelでは，正規分布の確率密度関数は`NORM.DIST`で計算できる。

**問題** 上の問いに関連して，`NORM.DIST(170, 160, 5, FALSE)`を計算すると0.010798になるが，これは身長170の人の割合が0.010798であることを意味するか。

**問題** 平均160，標準偏差5の正規分布の累積分布関数のグラフを描け。

**問題** `NORM.DIST(x, 平均, 標準偏差, FALSE)`と`NORM.DIST(x, 平均, 標準偏差, TRUE)`の違いを説明せよ。

**問題** 身長が平均160，標準偏差5の正規分布になっている集団について，以下の問に答えよ。

* 身長が145以下の人の割合を求めよ。
* 身長が150以下の人の割合を求めよ。
* 身長が145以上の人の割合を求めよ。
* 身長が150以上の人の割合を求めよ。

**問題（レポート課題）** 身長が平均160，標準偏差5の正規分布になっている集団について，以下の問に答えよ。

* 身長が145以上175以下の人の割合を求めよ。
* 身長が160-1.96×5以上160+1.96×5以下の人の割合を求めよ。
* 身長が150以上170以下の人の割合を求めよ。
* 身長が160-2.58×5以上160+2.58×5以下の人の割合を求めよ。
* 身長が155以上165以下の人の割合を求めよ。
