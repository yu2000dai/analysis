# 確率分布と乱数

## 離散型の場合

**問題** 理想的なサイコロを6回振った結果のデータを作り，その平均と分散，標準偏差を求めよ。

**問題** サイコロの出る目Xは確率変数である。Xがxである確率<img src="https://latex.codecogs.com/gif.latex?\inline&space;P(X=x)=f(x)" />はxの関数である。このような<img src="https://latex.codecogs.com/gif.latex?\inline&space;f(x)" />を確率分布と呼ぶ。サイコロが理想的な六面体のとき，<img src="https://latex.codecogs.com/gif.latex?\inline&space;f(x)" />は具体的にどうなるか。

**問題** 確率変数Xの期待値<img src="https://latex.codecogs.com/gif.latex?\inline&space;E(X)" />は，（Xが離散的なとき）<img src="https://latex.codecogs.com/gif.latex?\inline&space;\sum&space;x&space;f(x)" />で定義される（和はXの取り得るすべてのxについて取る）。理想的な六面体のサイコロの出る目Xの期待値を求めよ。

**問題** 確率変数Xの分散<img src="https://latex.codecogs.com/gif.latex?\inline&space;V(X)" />は，（Xが離散的なとき）<img src="https://latex.codecogs.com/gif.latex?\inline&space;\sum&space;(x-E(X))^2&space;f(x)" />で定義される（和はXの取り得るすべてのxについて取る）。理想的な六面体のサイコロの出る目Xの分散を求めよ。

**問題** 確率変数Xの標準偏差は，<img src="https://latex.codecogs.com/gif.latex?\inline&space;V(X)" />の平方根で定義される。理想的な六面体のサイコロの出る目Xの標準偏差を求めよ。

**問題（オプショナル）** 理想的な12面体のサイコロの出る目Xの期待値と分散，標準偏差を求めよ。

**問題** 当選金額が100万円，当選確率が10%のくじを100回買った場合をシミュレートし，その平均と分散，標準偏差を求めよ。

**問題** 当選金額が100万円，当選確率が10%のくじの，期待値と分散，標準偏差を求めよ。

**問題（オプショナル）** 1等（100万円）の当選確率が1%，2等（50万円）の当選確率が5%のくじの，期待値と分散，標準偏差を求めよ。

**問題** 表の出る確率がp，裏の出る確率がq=1-pであるコインを投げて，表が出ると1点，裏が出ると0点とする（表が出る回数を数えていると考えてもよい）。このコインを投げるという試行をn回繰り返したとする。そのときの合計点Xは確率変数であり，その確率分布は二項分布と呼ばれる。ここで述べた二項分布の確率分布（合計点がちょうどxになる確率）を求めよ。（調べてもよい。）

**問題** 上の問題の累積分布（合計点がx以下になる確率）の式を書け。

**問題** コインを10回投げて表が6回出る確率を，Excelで計算せよ。ヒント：`COMBIN`か`BINOM.DIST`を使う。

**問題** コインを10回投げて表が出る回数が6回以下になる確率を，Excelで計算せよ。

**問題** 二項分布の期待値と分散を求めよ。（調べてもよい。）

**問題** 当たる確率が0.1のガチャを10回引いて、1回も当たらない確率を求めよ。参考：http://www.wolframalpha.com/input/?i=BinomialDistribution%5B10,0.1%5D

**問題** 「当たる確率が0.1のガチャを10回引く」ということを100回繰り返し、当たった回数のヒストグラムを描け。

**問題（オプショナル）** 当たる確率が0.01のガチャを100回引いて、1回も当たらない確率を求めよ。

**問題（オプショナル）** 「当たる確率が0.01のガチャを100回引く」ということを100回繰り返し、当たった回数のヒストグラムを描け。

## 連続型の場合

**問題** 確率変数Xが連続値を取る場合，Xが<img src="https://latex.codecogs.com/gif.latex?\inline&space;[x,&space;x&plus;\Delta&space;x]" />に含まれる確率<img src="https://latex.codecogs.com/gif.latex?\inline&space;P(x\le&space;X&space;\le&space;x&plus;\Delta&space;x)=f(x)" />を考え，これを確率密度関数と呼ぶ。

**問題** 上の問いで、Xがx以下となる確率<img src="https://latex.codecogs.com/gif.latex?\inline&space;F(x)" />は<img src="https://latex.codecogs.com/gif.latex?\inline&space;\int_{-\infty}^x&space;f(k)\,dk" />であることを納得せよ。

**問題** 人間の身長は，正規分布になっていることが知られている。例として，平均160，標準偏差5の正規分布の確率密度関数のグラフを描け。ヒント：Excelでは，正規分布の確率密度関数は`NORM.DIST`で計算できる。

**問題** 上の問いに関連して，`NORM.DIST(170, 160, 5, FALSE)`を計算すると0.010798になるが，これは身長170の人の割合が0.010798であることを意味するか。

**問題** 平均160，標準偏差5の正規分布の累積分布関数のグラフを描け。

**問題** `NORM.DIST(x, 平均, 標準偏差, FALSE)`と`NORM.DIST(x, 平均, 標準偏差, TRUE)`の違いを説明せよ。

**問題** 身長が平均160，標準偏差5の正規分布になっている集団について，以下の問に答えよ。

* 身長が145以下の人の割合を求めよ。
* 身長が150以下の人の割合を求めよ。
* 身長が145以上の人の割合を求めよ。
* 身長が150以上の人の割合を求めよ。

**問題（オプショナル）** 身長が平均160，標準偏差5の正規分布になっている集団について，以下の問に答えよ。

* 身長が145以上175以下の人の割合を求めよ。
* 身長が160-1.96×5以上160+1.96×5以下の人の割合を求めよ。
* 身長が150以上170以下の人の割合を求めよ。
* 身長が160-2.58×5以上160+2.58×5以下の人の割合を求めよ。
* 身長が155以上165以下の人の割合を求めよ。
